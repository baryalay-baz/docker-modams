@using Microsoft.AspNetCore.Mvc.Localization
@using System.Globalization
@inject IViewLocalizer Localizer

@model List<MODAMS.Models.ViewModels.vwEmployees>

@{
    ViewData["TourPageKey"] = "Employees/Index";
    var _isSomali = CultureInfo.CurrentUICulture.Name == "so";
}

<!-- PAGE-HEADER -->
<div class="page-header" data-tour="emp.index.header">
    <div>
        <h1 class="page-title">@Localizer["Employees"]</h1>
    </div>
    <div class="ms-auto pageheader-btn">
        <ol class="breadcrumb" data-tour="emp.index.breadcrumbs">
            <li class="breadcrumb-item"><a asp-area="Users" asp-controller="Home" asp-action="Index">@Localizer["Dashboard"]</a></li>
            <li class="breadcrumb-item active" aria-current="page">@Localizer["EmployeeList"]</li>
        </ol>
    </div>
</div>
<!-- PAGE-HEADER END -->

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-body p-4">
                <div class="d-flex align-items-center justify-content-between">
                    <h4 class="m-0" data-tour="emp.index.section">@Localizer["EmployeeList"]</h4>
                    <div class="btn-list"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-12 col-sm-12">
        <div class="card">
            <div class="card-body project-list-table-container" data-tour="emp.index.table.container">
                <div class="table-responsive">
                    <div class="toolbar d-flex align-items-center gap-2 flex-wrap mb-2" data-tour="emp.index.toolbar">
                        <a asp-area="Admin" asp-controller="Employees" asp-action="CreateEmployee"
                           class="btn btn-outline-info"
                           title="@Localizer["NewEmployee"]"
                           data-tour="emp.index.create">
                            <i class="fa fa-circle-plus" aria-hidden="true"></i>
                            <span>@Localizer["NewEmployee"]</span>
                        </a>
                    </div>

                    <table id="tblEmployees"
                           class="table text-nowrap mb-0 table-bordered border-top border-bottom project-list-main"
                           data-tour="emp.index.table">
                        <thead class="table-head">
                            <tr>
                                <th class="bg-transparent border-bottom-0 w-5">@Localizer["SNo"]</th>
                                <th class="bg-transparent border-bottom-0">@Localizer["FullName"]</th>
                                <th class="bg-transparent border-bottom-0">@Localizer["JobTitle"]</th>
                                <th class="bg-transparent border-bottom-0">@Localizer["RoleName"]</th>
                                <th class="bg-transparent border-bottom-0">@Localizer["Department"]</th>
                                <th class="bg-transparent border-bottom-0">@Localizer["IsActive"]</th>
                            </tr>
                        </thead>
                        <tbody class="table-body">
                            @{
                                var n = 0;
                            }
                            @foreach (var employee in Model)
                            {
                                n++;
                                var sCounter = (n < 10) ? $"0{n}" : n.ToString();
                                var dept = _isSomali ? employee.DepartmentNameSo : employee.DepartmentName;
                                if (string.Equals(dept, "No Department Assigned", StringComparison.OrdinalIgnoreCase))
                                {
                                    dept = "";
                                }
                                <tr data-id="@employee.Id" data-active="@(employee.IsActive ? "1" : "0")">
                                    <td class="text-muted fs-15 fw-semibold text-center">@sCounter.</td>
                                    <td>
                                        <div class="d-flex align-items-center">
                                            <div class="me-2">
                                                <img style="min-width:30px;" src="@employee.ImageUrl" alt="profile-user" class="data-image avatar avatar-lg rounded-circle">
                                            </div>
                                            <div>
                                                <h6 class="mb-0">@employee.FullName</h6>
                                                <span class="text-muted fs-12">@employee.Email</span>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="text-muted fs-15 fw-semibold">@employee.JobTitle</td>
                                    <td class="text-muted fs-15 fw-semibold">@employee.RoleName</td>
                                    <td class="text-muted fs-15 fw-semibold">@dept</td>
                                    <td class="text-muted fs-15 fw-semibold">
                                        @if (employee.IsActive)
                                        {
                                            <span class="mb-0 mt-1 badge rounded-pill bg-primary-transparent text-blue">@Localizer["Active"]</span>
                                        }
                                        else
                                        {
                                            <span class="mb-0 mt-1 badge rounded-pill bg-secondary-transparent text-danger">@Localizer["Locked"]</span>
                                        }
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card-footer">
                <a asp-area="Users" asp-controller="Home" asp-action="Index"
                   class="btn btn-outline-default"
                   data-tour="emp.index.back">
                    <i class="fe fe-corner-up-left"></i>&nbsp;@Localizer["Previous"]
                </a>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <partial name="_DataTablesAssets" />
    <script src="~/js/pages/admin/employees/employees-index.js" asp-append-version="true"></script>
    <script src="~/js/tours/employees-index-tour.js" asp-append-version="true"></script>
}
